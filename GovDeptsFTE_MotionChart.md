Interactive chart of headcount in UK Government departments
========================================================








```r
print(Motion, "chart")
```

<!-- MotionChart generated in R 2.15.1 by googleVis 0.2.17 package -->
<!-- Thu Sep 27 11:09:57 2012 -->


<!-- jsHeader -->
<script type="text/javascript" src="http://www.google.com/jsapi">
</script>
<script type="text/javascript">
 
// jsData 
function gvisDataMotionChartID9cc422e2614 ()
{
  var data = new google.visualization.DataTable();
  var datajson =
[
 [
 "AGO",
"2009Q1",
         40,
       9580,
       9620 
],
[
 "BIS",
"2009Q1",
       4450,
       5540,
       9990 
],
[
 "CO",
"2009Q1",
       1270,
       1690,
       2960 
],
[
 "DCLG",
"2009Q1",
       2810,
       2390,
       5200 
],
[
 "DCMS",
"2009Q1",
        460,
        110,
        570 
],
[
 "DECC",
"2009Q1",
          0,
          0,
          0 
],
[
 "DEFRA",
"2009Q1",
       3000,
       7820,
      10820 
],
[
 "DfE",
"2009Q1",
       3190,
       2250,
       5440 
],
[
 "DfID",
"2009Q1",
       1600,
          0,
       1600 
],
[
 "DfT",
"2009Q1",
       2050,
      16570,
      18620 
],
[
 "DH",
"2009Q1",
       2260,
       3170,
       5430 
],
[
 "DWP",
"2009Q1",
          0,
     109260,
     109260 
],
[
 "FCO",
"2009Q1",
       5920,
       5500,
      11420 
],
[
 "GEO",
"2009Q1",
        100,
          0,
        100 
],
[
 "HMT",
"2009Q1",
       1240,
      89880,
      91120 
],
[
 "HO",
"2009Q1",
          0,
      24540,
      24540 
],
[
 "MoD",
"2009Q1",
          0,
      75630,
      75630 
],
[
 "MoJ",
"2009Q1",
       2990,
      81030,
      84020 
],
[
 "NIO",
"2009Q1",
        120,
          0,
        120 
],
[
 "Scot Gov",
"2009Q1",
          0,
      16390,
      16390 
],
[
 "Welsh Gov",
"2009Q1",
          0,
       5950,
       5950 
],
[
 "AGO",
"2009Q2",
         50,
       9530,
       9580 
],
[
 "BIS",
"2009Q2",
       4770,
       6620,
      11390 
],
[
 "CO",
"2009Q2",
       1300,
       1710,
       3010 
],
[
 "DCLG",
"2009Q2",
       2800,
       2370,
       5170 
],
[
 "DCMS",
"2009Q2",
        460,
        110,
        570 
],
[
 "DECC",
"2009Q2",
          0,
          0,
          0 
],
[
 "DEFRA",
"2009Q2",
       2860,
       7910,
      10770 
],
[
 "DfE",
"2009Q2",
       3220,
       2220,
       5440 
],
[
 "DfID",
"2009Q2",
       1630,
          0,
       1630 
],
[
 "DfT",
"2009Q2",
       2050,
      16620,
      18670 
],
[
 "DH",
"2009Q2",
       2240,
       3100,
       5340 
],
[
 "DWP",
"2009Q2",
          0,
     114110,
     114110 
],
[
 "FCO",
"2009Q2",
       5960,
       5620,
      11580 
],
[
 "GEO",
"2009Q2",
        100,
          0,
        100 
],
[
 "HMT",
"2009Q2",
       1310,
      88630,
      89940 
],
[
 "HO",
"2009Q2",
          0,
      24640,
      24640 
],
[
 "MoD",
"2009Q2",
          0,
      75470,
      75470 
],
[
 "MoJ",
"2009Q2",
       3020,
      79470,
      82490 
],
[
 "NIO",
"2009Q2",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2009Q2",
          0,
      16660,
      16660 
],
[
 "Welsh Gov",
"2009Q2",
          0,
       5940,
       5940 
],
[
 "AGO",
"2009Q3",
         50,
       9470,
       9520 
],
[
 "BIS",
"2009Q3",
       3870,
       6690,
      10560 
],
[
 "CO",
"2009Q3",
       1270,
       1720,
       2990 
],
[
 "DCLG",
"2009Q3",
       2660,
       2340,
       5000 
],
[
 "DCMS",
"2009Q3",
        460,
        110,
        570 
],
[
 "DECC",
"2009Q3",
        970,
          0,
        970 
],
[
 "DEFRA",
"2009Q3",
       2540,
       7900,
      10440 
],
[
 "DfE",
"2009Q3",
       3240,
       2150,
       5390 
],
[
 "DfID",
"2009Q3",
       1630,
          0,
       1630 
],
[
 "DfT",
"2009Q3",
       2060,
      16730,
      18790 
],
[
 "DH",
"2009Q3",
       2330,
       3070,
       5400 
],
[
 "DWP",
"2009Q3",
          0,
     121060,
     121060 
],
[
 "FCO",
"2009Q3",
       6020,
       5670,
      11690 
],
[
 "GEO",
"2009Q3",
        100,
          0,
        100 
],
[
 "HMT",
"2009Q3",
       1370,
      87540,
      88910 
],
[
 "HO",
"2009Q3",
          0,
      24780,
      24780 
],
[
 "MoD",
"2009Q3",
          0,
      75670,
      75670 
],
[
 "MoJ",
"2009Q3",
       3130,
      78580,
      81710 
],
[
 "NIO",
"2009Q3",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2009Q3",
          0,
      16780,
      16780 
],
[
 "Welsh Gov",
"2009Q3",
          0,
       6040,
       6040 
],
[
 "AGO",
"2009Q4",
         50,
       9600,
       9650 
],
[
 "BIS",
"2009Q4",
       3960,
       6730,
      10690 
],
[
 "CO",
"2009Q4",
       1270,
       1720,
       2990 
],
[
 "DCLG",
"2009Q4",
       2630,
       2220,
       4850 
],
[
 "DCMS",
"2009Q4",
        460,
        120,
        580 
],
[
 "DECC",
"2009Q4",
        990,
          0,
        990 
],
[
 "DEFRA",
"2009Q4",
       2570,
       7840,
      10410 
],
[
 "DfE",
"2009Q4",
       3180,
       2070,
       5250 
],
[
 "DfID",
"2009Q4",
       1570,
          0,
       1570 
],
[
 "DfT",
"2009Q4",
       2080,
      16730,
      18810 
],
[
 "DH",
"2009Q4",
       2360,
       2930,
       5290 
],
[
 "DWP",
"2009Q4",
          0,
     122920,
     122920 
],
[
 "FCO",
"2009Q4",
       6120,
       5710,
      11830 
],
[
 "GEO",
"2009Q4",
         90,
          0,
         90 
],
[
 "HMT",
"2009Q4",
       1350,
      85940,
      87290 
],
[
 "HO",
"2009Q4",
          0,
      24800,
      24800 
],
[
 "MoD",
"2009Q4",
          0,
      75700,
      75700 
],
[
 "MoJ",
"2009Q4",
       3110,
      78120,
      81230 
],
[
 "NIO",
"2009Q4",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2009Q4",
          0,
      16700,
      16700 
],
[
 "Welsh Gov",
"2009Q4",
          0,
       6020,
       6020 
],
[
 "AGO",
"2010Q1",
         50,
       9450,
       9500 
],
[
 "BIS",
"2010Q1",
       3940,
       6780,
      10720 
],
[
 "CO",
"2010Q1",
       1230,
       1690,
       2920 
],
[
 "DCLG",
"2010Q1",
       2650,
       2140,
       4790 
],
[
 "DCMS",
"2010Q1",
        470,
        120,
        590 
],
[
 "DECC",
"2010Q1",
       1020,
          0,
       1020 
],
[
 "DEFRA",
"2010Q1",
       2640,
       7730,
      10370 
],
[
 "DfE",
"2010Q1",
       2650,
       2060,
       4710 
],
[
 "DfID",
"2010Q1",
       1570,
          0,
       1570 
],
[
 "DfT",
"2010Q1",
       2080,
      16550,
      18630 
],
[
 "DH",
"2010Q1",
       2630,
       2770,
       5400 
],
[
 "DWP",
"2010Q1",
          0,
     120940,
     120940 
],
[
 "FCO",
"2010Q1",
       5900,
       5650,
      11550 
],
[
 "GEO",
"2010Q1",
        120,
          0,
        120 
],
[
 "HMT",
"2010Q1",
       1330,
      84530,
      85860 
],
[
 "HO",
"2010Q1",
          0,
      24990,
      24990 
],
[
 "MoD",
"2010Q1",
          0,
      75230,
      75230 
],
[
 "MoJ",
"2010Q1",
       3130,
      77410,
      80540 
],
[
 "NIO",
"2010Q1",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2010Q1",
          0,
      16780,
      16780 
],
[
 "Welsh Gov",
"2010Q1",
          0,
       5990,
       5990 
],
[
 "AGO",
"2010Q2",
         40,
       9230,
       9270 
],
[
 "BIS",
"2010Q2",
       3860,
       8550,
      12410 
],
[
 "CO",
"2010Q2",
       1600,
       2040,
       3640 
],
[
 "DCLG",
"2010Q2",
       2580,
       2120,
       4700 
],
[
 "DCMS",
"2010Q2",
        480,
        120,
        600 
],
[
 "DECC",
"2010Q2",
       1060,
          0,
       1060 
],
[
 "DEFRA",
"2010Q2",
       2640,
       7290,
       9930 
],
[
 "DfE",
"2010Q2",
       2890,
       2170,
       5060 
],
[
 "DfID",
"2010Q2",
       1580,
          0,
       1580 
],
[
 "DfT",
"2010Q2",
       2070,
      16540,
      18610 
],
[
 "DH",
"2010Q2",
       2600,
       2720,
       5320 
],
[
 "DWP",
"2010Q2",
          0,
     118350,
     118350 
],
[
 "FCO",
"2010Q2",
       5890,
       5660,
      11550 
],
[
 "GEO",
"2010Q2",
        120,
          0,
        120 
],
[
 "HMT",
"2010Q2",
       1350,
      76850,
      78200 
],
[
 "HO",
"2010Q2",
          0,
      29540,
      29540 
],
[
 "MoD",
"2010Q2",
          0,
      74610,
      74610 
],
[
 "MoJ",
"2010Q2",
       3350,
      76790,
      80140 
],
[
 "NIO",
"2010Q2",
        130,
          0,
        130 
],
[
 "Scot Gov",
"2010Q2",
          0,
      16870,
      16870 
],
[
 "Welsh Gov",
"2010Q2",
          0,
       5910,
       5910 
],
[
 "AGO",
"2010Q3",
         50,
       9100,
       9150 
],
[
 "BIS",
"2010Q3",
       3760,
       8460,
      12220 
],
[
 "CO",
"2010Q3",
       1500,
       1950,
       3450 
],
[
 "DCLG",
"2010Q3",
       2520,
       2090,
       4610 
],
[
 "DCMS",
"2010Q3",
        460,
        110,
        570 
],
[
 "DECC",
"2010Q3",
       1120,
          0,
       1120 
],
[
 "DEFRA",
"2010Q3",
       2590,
       7070,
       9660 
],
[
 "DfE",
"2010Q3",
       2800,
       1670,
       4470 
],
[
 "DfID",
"2010Q3",
       1600,
          0,
       1600 
],
[
 "DfT",
"2010Q3",
       2070,
      16330,
      18400 
],
[
 "DH",
"2010Q3",
       2540,
       2570,
       5110 
],
[
 "DWP",
"2010Q3",
          0,
     115430,
     115430 
],
[
 "FCO",
"2010Q3",
       5900,
       5660,
      11560 
],
[
 "GEO",
"2010Q3",
        110,
          0,
        110 
],
[
 "HMT",
"2010Q3",
       1360,
      75140,
      76500 
],
[
 "HO",
"2010Q3",
          0,
      29070,
      29070 
],
[
 "MoD",
"2010Q3",
          0,
      73590,
      73590 
],
[
 "MoJ",
"2010Q3",
       3300,
      75930,
      79230 
],
[
 "NIO",
"2010Q3",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2010Q3",
          0,
      16820,
      16820 
],
[
 "Welsh Gov",
"2010Q3",
          0,
       5610,
       5610 
],
[
 "AGO",
"2010Q4",
         40,
       8980,
       9020 
],
[
 "BIS",
"2010Q4",
       3420,
       8200,
      11620 
],
[
 "CO",
"2010Q4",
       1460,
       1630,
       3090 
],
[
 "DCLG",
"2010Q4",
       2470,
       2050,
       4520 
],
[
 "DCMS",
"2010Q4",
        460,
        120,
        580 
],
[
 "DECC",
"2010Q4",
       1130,
          0,
       1130 
],
[
 "DEFRA",
"2010Q4",
       2570,
       6910,
       9480 
],
[
 "DfE",
"2010Q4",
       2740,
       1630,
       4370 
],
[
 "DfID",
"2010Q4",
       1580,
          0,
       1580 
],
[
 "DfT",
"2010Q4",
       2030,
      16120,
      18150 
],
[
 "DH",
"2010Q4",
       2570,
       2520,
       5090 
],
[
 "DWP",
"2010Q4",
          0,
     112320,
     112320 
],
[
 "FCO",
"2010Q4",
       5770,
       5630,
      11400 
],
[
 "GEO",
"2010Q4",
        110,
          0,
        110 
],
[
 "HMT",
"2010Q4",
       1300,
      74290,
      75590 
],
[
 "HO",
"2010Q4",
          0,
      27910,
      27910 
],
[
 "MoD",
"2010Q4",
          0,
      73130,
      73130 
],
[
 "MoJ",
"2010Q4",
       4470,
      74320,
      78790 
],
[
 "NIO",
"2010Q4",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2010Q4",
          0,
      16690,
      16690 
],
[
 "Welsh Gov",
"2010Q4",
          0,
       5550,
       5550 
],
[
 "AGO",
"2011Q1",
         40,
       8900,
       8940 
],
[
 "BIS",
"2011Q1",
       3400,
       8120,
      11520 
],
[
 "CO",
"2011Q1",
       1520,
       1580,
       3100 
],
[
 "DCLG",
"2011Q1",
       2250,
       1950,
       4200 
],
[
 "DCMS",
"2011Q1",
        450,
        120,
        570 
],
[
 "DECC",
"2011Q1",
       1150,
          0,
       1150 
],
[
 "DEFRA",
"2011Q1",
       2530,
       6880,
       9410 
],
[
 "DfE",
"2011Q1",
       2660,
       1620,
       4280 
],
[
 "DfID",
"2011Q1",
       1570,
          0,
       1570 
],
[
 "DfT",
"2011Q1",
       1860,
      15810,
      17670 
],
[
 "DH",
"2011Q1",
       2560,
       2460,
       5020 
],
[
 "DWP",
"2011Q1",
          0,
     109590,
     109590 
],
[
 "FCO",
"2011Q1",
       5660,
       5370,
      11030 
],
[
 "GEO",
"2011Q1",
        110,
          0,
        110 
],
[
 "HMT",
"2011Q1",
       1240,
      80330,
      81570 
],
[
 "HO",
"2011Q1",
          0,
      27380,
      27380 
],
[
 "MoD",
"2011Q1",
          0,
      72080,
      72080 
],
[
 "MoJ",
"2011Q1",
       4510,
      73700,
      78210 
],
[
 "NIO",
"2011Q1",
        100,
          0,
        100 
],
[
 "Scot Gov",
"2011Q1",
          0,
      17890,
      17890 
],
[
 "Welsh Gov",
"2011Q1",
          0,
       5450,
       5450 
],
[
 "AGO",
"2011Q2",
         40,
       8670,
       8710 
],
[
 "BIS",
"2011Q2",
       3170,
       7630,
      10800 
],
[
 "CO",
"2011Q2",
       1630,
       1330,
       2960 
],
[
 "DCLG",
"2011Q2",
       2020,
       1910,
       3930 
],
[
 "DCMS",
"2011Q2",
        490,
        120,
        610 
],
[
 "DECC",
"2011Q2",
       1170,
          0,
       1170 
],
[
 "DEFRA",
"2011Q2",
       2340,
       6870,
       9210 
],
[
 "DfE",
"2011Q2",
       2490,
       1610,
       4100 
],
[
 "DfID",
"2011Q2",
       1560,
          0,
       1560 
],
[
 "DfT",
"2011Q2",
       1780,
      15600,
      17380 
],
[
 "DH",
"2011Q2",
       2390,
       2460,
       4850 
],
[
 "DWP",
"2011Q2",
          0,
     105700,
     105700 
],
[
 "FCO",
"2011Q2",
       5560,
       5350,
      10910 
],
[
 "GEO",
"2011Q2",
          0,
          0,
          0 
],
[
 "HMT",
"2011Q2",
       1170,
      74820,
      75990 
],
[
 "HO",
"2011Q2",
          0,
      26310,
      26310 
],
[
 "MoD",
"2011Q2",
          0,
      70680,
      70680 
],
[
 "MoJ",
"2011Q2",
       4300,
      71750,
      76050 
],
[
 "NIO",
"2011Q2",
         50,
          0,
         50 
],
[
 "Scot Gov",
"2011Q2",
          0,
      16300,
      16300 
],
[
 "Welsh Gov",
"2011Q2",
          0,
       5300,
       5300 
],
[
 "AGO",
"2011Q3",
         40,
       8460,
       8500 
],
[
 "BIS",
"2011Q3",
       2880,
      14880,
      17760 
],
[
 "CO",
"2011Q3",
       1630,
       1230,
       2860 
],
[
 "DCLG",
"2011Q3",
       2110,
        840,
       2950 
],
[
 "DCMS",
"2011Q3",
        460,
        110,
        570 
],
[
 "DECC",
"2011Q3",
       1190,
          0,
       1190 
],
[
 "DEFRA",
"2011Q3",
       2100,
       6560,
       8660 
],
[
 "DfE",
"2011Q3",
       2490,
       1590,
       4080 
],
[
 "DfID",
"2011Q3",
       1560,
          0,
       1560 
],
[
 "DfT",
"2011Q3",
       1710,
      15460,
      17170 
],
[
 "DH",
"2011Q3",
       2370,
       2240,
       4610 
],
[
 "DWP",
"2011Q3",
          0,
     102380,
     102380 
],
[
 "FCO",
"2011Q3",
       5450,
       5310,
      10760 
],
[
 "GEO",
"2011Q3",
          0,
          0,
          0 
],
[
 "HMT",
"2011Q3",
       1150,
      74060,
      75210 
],
[
 "HO",
"2011Q3",
          0,
      25580,
      25580 
],
[
 "MoD",
"2011Q3",
          0,
      68000,
      68000 
],
[
 "MoJ",
"2011Q3",
       4250,
      66470,
      70720 
],
[
 "NIO",
"2011Q3",
         50,
          0,
         50 
],
[
 "Scot Gov",
"2011Q3",
          0,
      16080,
      16080 
],
[
 "Welsh Gov",
"2011Q3",
          0,
       5110,
       5110 
],
[
 "AGO",
"2011Q4",
         40,
       8340,
       8380 
],
[
 "BIS",
"2011Q4",
       2910,
      14570,
      17480 
],
[
 "CO",
"2011Q4",
       1640,
       1200,
       2840 
],
[
 "DCLG",
"2011Q4",
       1860,
        840,
       2700 
],
[
 "DCMS",
"2011Q4",
        460,
        110,
        570 
],
[
 "DECC",
"2011Q4",
       1230,
          0,
       1230 
],
[
 "DEFRA",
"2011Q4",
       2080,
       6440,
       8520 
],
[
 "DfE",
"2011Q4",
       2580,
       1670,
       4250 
],
[
 "DfID",
"2011Q4",
       1620,
          0,
       1620 
],
[
 "DfT",
"2011Q4",
       1660,
      15370,
      17030 
],
[
 "DH",
"2011Q4",
       2330,
       2210,
       4540 
],
[
 "DWP",
"2011Q4",
          0,
     101100,
     101100 
],
[
 "FCO",
"2011Q4",
       5770,
       5290,
      11060 
],
[
 "GEO",
"2011Q4",
          0,
          0,
          0 
],
[
 "HMT",
"2011Q4",
       1130,
      73870,
      75000 
],
[
 "HO",
"2011Q4",
          0,
      24850,
      24850 
],
[
 "MoD",
"2011Q4",
          0,
      64590,
      64590 
],
[
 "MoJ",
"2011Q4",
       4160,
      64450,
      68610 
],
[
 "NIO",
"2011Q4",
         50,
          0,
         50 
],
[
 "Scot Gov",
"2011Q4",
          0,
      15800,
      15800 
],
[
 "Welsh Gov",
"2011Q4",
          0,
       5100,
       5100 
],
[
 "AGO",
"2012Q1",
         40,
       8340,
       8380 
],
[
 "BIS",
"2012Q1",
       2930,
      14220,
      17150 
],
[
 "CO",
"2012Q1",
       1710,
       1100,
       2810 
],
[
 "DCLG",
"2012Q1",
       1820,
        820,
       2640 
],
[
 "DCMS",
"2012Q1",
        450,
        120,
        570 
],
[
 "DECC",
"2012Q1",
       1290,
          0,
       1290 
],
[
 "DEFRA",
"2012Q1",
       2090,
       6400,
       8490 
],
[
 "DfE",
"2012Q1",
       2590,
       1670,
       4260 
],
[
 "DfID",
"2012Q1",
       1650,
          0,
       1650 
],
[
 "DfT",
"2012Q1",
       1630,
      15290,
      16920 
],
[
 "DH",
"2012Q1",
       2290,
       2180,
       4470 
],
[
 "DWP",
"2012Q1",
          0,
      99800,
      99800 
],
[
 "FCO",
"2012Q1",
       5780,
       5290,
      11070 
],
[
 "GEO",
"2012Q1",
          0,
          0,
          0 
],
[
 "HMT",
"2012Q1",
       1200,
      73340,
      74540 
],
[
 "HO",
"2012Q1",
          0,
      24640,
      24640 
],
[
 "MoD",
"2012Q1",
          0,
      61330,
      61330 
],
[
 "MoJ",
"2012Q1",
       4060,
      63290,
      67350 
],
[
 "NIO",
"2012Q1",
         60,
          0,
         60 
],
[
 "Scot Gov",
"2012Q1",
          0,
      15720,
      15720 
],
[
 "Welsh Gov",
"2012Q1",
          0,
       5170,
       5170 
],
[
 "AGO",
"2012Q2",
         40,
       8280,
       8320 
],
[
 "BIS",
"2012Q2",
          0,
      14220,
      14220 
],
[
 "CO",
"2012Q2",
       1800,
        720,
       2520 
],
[
 "DCLG",
"2012Q2",
       1700,
        840,
       2540 
],
[
 "DCMS",
"2012Q2",
        450,
        130,
        580 
],
[
 "DECC",
"2012Q2",
       1320,
          0,
       1320 
],
[
 "DEFRA",
"2012Q2",
       2060,
       6290,
       8350 
],
[
 "DfE",
"2012Q2",
       2630,
       1630,
       4260 
],
[
 "DfID",
"2012Q2",
       1690,
          0,
       1690 
],
[
 "DfT",
"2012Q2",
       1640,
      15200,
      16840 
],
[
 "DH",
"2012Q2",
       2270,
       2180,
       4450 
],
[
 "DWP",
"2012Q2",
          0,
      98210,
      98210 
],
[
 "FCO",
"2012Q2",
       6420,
       5260,
      11680 
],
[
 "GEO",
"2012Q2",
          0,
          0,
          0 
],
[
 "HMT",
"2012Q2",
       1160,
      72520,
      73680 
],
[
 "HO",
"2012Q2",
          0,
      24520,
      24520 
],
[
 "MoD",
"2012Q2",
          0,
      59640,
      59640 
],
[
 "MoJ",
"2012Q2",
       4260,
      61890,
      66150 
],
[
 "NIO",
"2012Q2",
         90,
          0,
         90 
],
[
 "Scot Gov",
"2012Q2",
          0,
      15770,
      15770 
],
[
 "Welsh Gov",
"2012Q2",
          0,
       5230,
       5230 
] 
];
data.addColumn('string','Dept');
data.addColumn('string','Period');
data.addColumn('number','FTE_WH');
data.addColumn('number','FTE_NWH');
data.addColumn('number','FTE_total');
data.addRows(datajson);
return(data);
}
 
// jsDrawChart
function drawChartMotionChartID9cc422e2614() {
  var data = gvisDataMotionChartID9cc422e2614();
  var options = {};
options["width"] =   1000;
options["height"] =    400;
options["state"] = "{\"playDuration\":10000,\n                       \"xZoomedDataMin\":0,\n                       \"xZoomedIn\":false,\n                       \"time\":\"2010-07-01\",\n                       \"yZoomedIn\":false,\n                       \"orderedByY\":false,\n                       \"sizeOption\":\"_UNISIZE\",\n                       \"xLambda\":1,\n                       \"colorOption\":\"4\",\n                       \"yZoomedDataMax\":130000,\n                       \"nonSelectedAlpha\":0.4,\n                       \"iconType\":\"VBAR\",\n                       \"dimensions\":{\"iconDimensions\":[\"dim0\"]},\n                       \"uniColorForNonSelected\":false,\n                       \"yZoomedDataMin\":0,\n                       \"xZoomedDataMax\":21,\n                       \"duration\":{\"multiplier\":1,\"timeUnit\":\"Q\"},\n                       \"xAxisOption\":\"_ALPHABETICAL\",\n                       \"orderedByX\":true,\n                       \"showTrails\":false,\n                       \"yLambda\":1,\n                       \"yAxisOption\":\"4\",\n                       \"iconKeySettings\":[]};";
options["showSelectListComponent"] =      1;
options["showHeader"] =      1;
options["showAdvancedPanel"] =      1;
options["showChartButtons"] =      1;
options["showXScalePicker"] =      1;
options["showYScalePicker"] =      1;
options["showXMetricPicker"] =      1;
options["showYMetricPicker"] =      1;
options["showSidePanel"] =      1;

     var chart = new google.visualization.MotionChart(
       document.getElementById('MotionChartID9cc422e2614')
     );
     chart.draw(data,options);
    

}
  
 
// jsDisplayChart 
function displayChartMotionChartID9cc422e2614()
{
  google.load("visualization", "1", { packages:["motionchart"] }); 
  google.setOnLoadCallback(drawChartMotionChartID9cc422e2614);
}
 
// jsChart 
displayChartMotionChartID9cc422e2614()
 
<!-- jsFooter -->  
//-->
</script>
 
<!-- divChart -->
  
<div id="MotionChartID9cc422e2614"
  style="width: 1000px; height: 400px;">
</div>



```r
library(plyr)

# this is just showing code, to be copied from above when updated

# load data
RawDeptsFTE <- read.csv("data/RawDeptsFTE.csv")

# get rid of fluff in colnames, making it suitable for reshape and
# googlevis
names(RawDeptsFTE) <- gsub("[.]", "", names(RawDeptsFTE))
names(RawDeptsFTE) <- gsub("FTE", "", names(RawDeptsFTE))
names(RawDeptsFTE) <- gsub("X", "FTE", names(RawDeptsFTE))

DeptsFTE <- ddply(RawDeptsFTE, .(Dept, Whitehall), summarise, FTE2009Q1 = sum(FTE2009Q1, 
    na.rm = TRUE), FTE2009Q2 = sum(FTE2009Q2, na.rm = TRUE), FTE2009Q3 = sum(FTE2009Q3, 
    na.rm = TRUE), FTE2009Q4 = sum(FTE2009Q4, na.rm = TRUE), FTE2010Q1 = sum(FTE2010Q1, 
    na.rm = TRUE), FTE2010Q2 = sum(FTE2010Q2, na.rm = TRUE), FTE2010Q3 = sum(FTE2010Q3, 
    na.rm = TRUE), FTE2010Q4 = sum(FTE2010Q4, na.rm = TRUE), FTE2011Q1 = sum(FTE2011Q1, 
    na.rm = TRUE), FTE2011Q2 = sum(FTE2011Q2, na.rm = TRUE), FTE2011Q3 = sum(FTE2011Q3, 
    na.rm = TRUE), FTE2011Q4 = sum(FTE2011Q4, na.rm = TRUE), FTE2012Q1 = sum(FTE2012Q1, 
    na.rm = TRUE), FTE2012Q2 = sum(FTE2012Q2, na.rm = TRUE))

# convert to wide to create WH and NWH FTE vars for each

DeptsFTEwide <- reshape(DeptsFTE, idvar = "Dept", timevar = "Whitehall", direction = "wide")

# make names manageable
names(DeptsFTEwide) <- gsub("sFTE", "", names(DeptsFTEwide))
names(DeptsFTEwide) <- gsub(".Core Whitehall Depts.", "WH", names(DeptsFTEwide))
names(DeptsFTEwide) <- gsub(".Non-Whitehall Civil Service", "NWH", names(DeptsFTEwide))

# convert to long
DeptsFTElong <- reshape(DeptsFTEwide, idvar = c("Dept"), varying = list(c(2:15), 
    c(16:29)), v.names = c("FTE_WH", "FTE_NWH"), times = c("2009Q1", "2009Q2", 
    "2009Q3", "2009Q4", "2010Q1", "2010Q2", "2010Q3", "2010Q4", "2011Q1", "2011Q2", 
    "2011Q3", "2011Q4", "2012Q1", "2012Q2"), timevar = "Period", direction = "long")

# Notes: yLambda: 0 is log, 1 is linear timeUnit: originally was _NOTHING
# playduration is in ms need to set xaxisoption to _NOTHING if showing
# bubble by default

```



```r

# this is same code as above, just with bubble chart - again, to be copied
# when code above is updated

suppressPackageStartupMessages(library(googleVis))

Motion=gvisMotionChart(DeptsFTElong, idvar="Dept", timevar="Period",
                       options=list(
                       height=400, 
                       width=1000, 
                       state="{\"playDuration\":10000,
                       \"xZoomedDataMin\":0,
                       \"xZoomedIn\":false,
                       \"time\":\"2010-07-01\",
                       \"yZoomedIn\":false,
                       \"orderedByY\":false,
                       \"sizeOption\":\"4\",
                       \"xLambda\":1,
                       \"colorOption\":\"2\",
                       \"yZoomedDataMax\":130000,
                       \"nonSelectedAlpha\":0.4,
                       \"iconType\":\"BUBBLE\",
                       \"dimensions\":{\"iconDimensions\":[\"dim0\"]},
                       \"uniColorForNonSelected\":false,
                       \"yZoomedDataMin\":0,
                       \"xZoomedDataMax\":21,
                       \"duration\":{\"multiplier\":1,\"timeUnit\":\"Q\"},
                       \"xAxisOption\":\"3\",
                       \"orderedByX\":true,
                       \"showTrails\":false,
                       \"yLambda\":1,
                       \"yAxisOption\":\"2\",
                       \"iconKeySettings\":[]};",
                       showSelectListComponent = 1,
                       showHeader=1,
                       showAdvancedPanel=1,
                       showChartButtons=1,
                       showXScalePicker=1,
                       showYScalePicker=1,
                       showXMetricPicker=1,
                       showYMetricPicker=1,
                       showSidePanel=1
                       ))
```



<!-- MotionChart generated in R 2.15.1 by googleVis 0.2.17 package -->
<!-- Thu Sep 27 11:09:58 2012 -->


<!-- jsHeader -->
<script type="text/javascript" src="http://www.google.com/jsapi">
</script>
<script type="text/javascript">
 
// jsData 
function gvisDataMotionChartID9cc44be2e85 ()
{
  var data = new google.visualization.DataTable();
  var datajson =
[
 [
 "AGO",
"2009Q1",
         40,
       9580,
       9620 
],
[
 "BIS",
"2009Q1",
       4450,
       5540,
       9990 
],
[
 "CO",
"2009Q1",
       1270,
       1690,
       2960 
],
[
 "DCLG",
"2009Q1",
       2810,
       2390,
       5200 
],
[
 "DCMS",
"2009Q1",
        460,
        110,
        570 
],
[
 "DECC",
"2009Q1",
          0,
          0,
          0 
],
[
 "DEFRA",
"2009Q1",
       3000,
       7820,
      10820 
],
[
 "DfE",
"2009Q1",
       3190,
       2250,
       5440 
],
[
 "DfID",
"2009Q1",
       1600,
          0,
       1600 
],
[
 "DfT",
"2009Q1",
       2050,
      16570,
      18620 
],
[
 "DH",
"2009Q1",
       2260,
       3170,
       5430 
],
[
 "DWP",
"2009Q1",
          0,
     109260,
     109260 
],
[
 "FCO",
"2009Q1",
       5920,
       5500,
      11420 
],
[
 "GEO",
"2009Q1",
        100,
          0,
        100 
],
[
 "HMT",
"2009Q1",
       1240,
      89880,
      91120 
],
[
 "HO",
"2009Q1",
          0,
      24540,
      24540 
],
[
 "MoD",
"2009Q1",
          0,
      75630,
      75630 
],
[
 "MoJ",
"2009Q1",
       2990,
      81030,
      84020 
],
[
 "NIO",
"2009Q1",
        120,
          0,
        120 
],
[
 "Scot Gov",
"2009Q1",
          0,
      16390,
      16390 
],
[
 "Welsh Gov",
"2009Q1",
          0,
       5950,
       5950 
],
[
 "AGO",
"2009Q2",
         50,
       9530,
       9580 
],
[
 "BIS",
"2009Q2",
       4770,
       6620,
      11390 
],
[
 "CO",
"2009Q2",
       1300,
       1710,
       3010 
],
[
 "DCLG",
"2009Q2",
       2800,
       2370,
       5170 
],
[
 "DCMS",
"2009Q2",
        460,
        110,
        570 
],
[
 "DECC",
"2009Q2",
          0,
          0,
          0 
],
[
 "DEFRA",
"2009Q2",
       2860,
       7910,
      10770 
],
[
 "DfE",
"2009Q2",
       3220,
       2220,
       5440 
],
[
 "DfID",
"2009Q2",
       1630,
          0,
       1630 
],
[
 "DfT",
"2009Q2",
       2050,
      16620,
      18670 
],
[
 "DH",
"2009Q2",
       2240,
       3100,
       5340 
],
[
 "DWP",
"2009Q2",
          0,
     114110,
     114110 
],
[
 "FCO",
"2009Q2",
       5960,
       5620,
      11580 
],
[
 "GEO",
"2009Q2",
        100,
          0,
        100 
],
[
 "HMT",
"2009Q2",
       1310,
      88630,
      89940 
],
[
 "HO",
"2009Q2",
          0,
      24640,
      24640 
],
[
 "MoD",
"2009Q2",
          0,
      75470,
      75470 
],
[
 "MoJ",
"2009Q2",
       3020,
      79470,
      82490 
],
[
 "NIO",
"2009Q2",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2009Q2",
          0,
      16660,
      16660 
],
[
 "Welsh Gov",
"2009Q2",
          0,
       5940,
       5940 
],
[
 "AGO",
"2009Q3",
         50,
       9470,
       9520 
],
[
 "BIS",
"2009Q3",
       3870,
       6690,
      10560 
],
[
 "CO",
"2009Q3",
       1270,
       1720,
       2990 
],
[
 "DCLG",
"2009Q3",
       2660,
       2340,
       5000 
],
[
 "DCMS",
"2009Q3",
        460,
        110,
        570 
],
[
 "DECC",
"2009Q3",
        970,
          0,
        970 
],
[
 "DEFRA",
"2009Q3",
       2540,
       7900,
      10440 
],
[
 "DfE",
"2009Q3",
       3240,
       2150,
       5390 
],
[
 "DfID",
"2009Q3",
       1630,
          0,
       1630 
],
[
 "DfT",
"2009Q3",
       2060,
      16730,
      18790 
],
[
 "DH",
"2009Q3",
       2330,
       3070,
       5400 
],
[
 "DWP",
"2009Q3",
          0,
     121060,
     121060 
],
[
 "FCO",
"2009Q3",
       6020,
       5670,
      11690 
],
[
 "GEO",
"2009Q3",
        100,
          0,
        100 
],
[
 "HMT",
"2009Q3",
       1370,
      87540,
      88910 
],
[
 "HO",
"2009Q3",
          0,
      24780,
      24780 
],
[
 "MoD",
"2009Q3",
          0,
      75670,
      75670 
],
[
 "MoJ",
"2009Q3",
       3130,
      78580,
      81710 
],
[
 "NIO",
"2009Q3",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2009Q3",
          0,
      16780,
      16780 
],
[
 "Welsh Gov",
"2009Q3",
          0,
       6040,
       6040 
],
[
 "AGO",
"2009Q4",
         50,
       9600,
       9650 
],
[
 "BIS",
"2009Q4",
       3960,
       6730,
      10690 
],
[
 "CO",
"2009Q4",
       1270,
       1720,
       2990 
],
[
 "DCLG",
"2009Q4",
       2630,
       2220,
       4850 
],
[
 "DCMS",
"2009Q4",
        460,
        120,
        580 
],
[
 "DECC",
"2009Q4",
        990,
          0,
        990 
],
[
 "DEFRA",
"2009Q4",
       2570,
       7840,
      10410 
],
[
 "DfE",
"2009Q4",
       3180,
       2070,
       5250 
],
[
 "DfID",
"2009Q4",
       1570,
          0,
       1570 
],
[
 "DfT",
"2009Q4",
       2080,
      16730,
      18810 
],
[
 "DH",
"2009Q4",
       2360,
       2930,
       5290 
],
[
 "DWP",
"2009Q4",
          0,
     122920,
     122920 
],
[
 "FCO",
"2009Q4",
       6120,
       5710,
      11830 
],
[
 "GEO",
"2009Q4",
         90,
          0,
         90 
],
[
 "HMT",
"2009Q4",
       1350,
      85940,
      87290 
],
[
 "HO",
"2009Q4",
          0,
      24800,
      24800 
],
[
 "MoD",
"2009Q4",
          0,
      75700,
      75700 
],
[
 "MoJ",
"2009Q4",
       3110,
      78120,
      81230 
],
[
 "NIO",
"2009Q4",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2009Q4",
          0,
      16700,
      16700 
],
[
 "Welsh Gov",
"2009Q4",
          0,
       6020,
       6020 
],
[
 "AGO",
"2010Q1",
         50,
       9450,
       9500 
],
[
 "BIS",
"2010Q1",
       3940,
       6780,
      10720 
],
[
 "CO",
"2010Q1",
       1230,
       1690,
       2920 
],
[
 "DCLG",
"2010Q1",
       2650,
       2140,
       4790 
],
[
 "DCMS",
"2010Q1",
        470,
        120,
        590 
],
[
 "DECC",
"2010Q1",
       1020,
          0,
       1020 
],
[
 "DEFRA",
"2010Q1",
       2640,
       7730,
      10370 
],
[
 "DfE",
"2010Q1",
       2650,
       2060,
       4710 
],
[
 "DfID",
"2010Q1",
       1570,
          0,
       1570 
],
[
 "DfT",
"2010Q1",
       2080,
      16550,
      18630 
],
[
 "DH",
"2010Q1",
       2630,
       2770,
       5400 
],
[
 "DWP",
"2010Q1",
          0,
     120940,
     120940 
],
[
 "FCO",
"2010Q1",
       5900,
       5650,
      11550 
],
[
 "GEO",
"2010Q1",
        120,
          0,
        120 
],
[
 "HMT",
"2010Q1",
       1330,
      84530,
      85860 
],
[
 "HO",
"2010Q1",
          0,
      24990,
      24990 
],
[
 "MoD",
"2010Q1",
          0,
      75230,
      75230 
],
[
 "MoJ",
"2010Q1",
       3130,
      77410,
      80540 
],
[
 "NIO",
"2010Q1",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2010Q1",
          0,
      16780,
      16780 
],
[
 "Welsh Gov",
"2010Q1",
          0,
       5990,
       5990 
],
[
 "AGO",
"2010Q2",
         40,
       9230,
       9270 
],
[
 "BIS",
"2010Q2",
       3860,
       8550,
      12410 
],
[
 "CO",
"2010Q2",
       1600,
       2040,
       3640 
],
[
 "DCLG",
"2010Q2",
       2580,
       2120,
       4700 
],
[
 "DCMS",
"2010Q2",
        480,
        120,
        600 
],
[
 "DECC",
"2010Q2",
       1060,
          0,
       1060 
],
[
 "DEFRA",
"2010Q2",
       2640,
       7290,
       9930 
],
[
 "DfE",
"2010Q2",
       2890,
       2170,
       5060 
],
[
 "DfID",
"2010Q2",
       1580,
          0,
       1580 
],
[
 "DfT",
"2010Q2",
       2070,
      16540,
      18610 
],
[
 "DH",
"2010Q2",
       2600,
       2720,
       5320 
],
[
 "DWP",
"2010Q2",
          0,
     118350,
     118350 
],
[
 "FCO",
"2010Q2",
       5890,
       5660,
      11550 
],
[
 "GEO",
"2010Q2",
        120,
          0,
        120 
],
[
 "HMT",
"2010Q2",
       1350,
      76850,
      78200 
],
[
 "HO",
"2010Q2",
          0,
      29540,
      29540 
],
[
 "MoD",
"2010Q2",
          0,
      74610,
      74610 
],
[
 "MoJ",
"2010Q2",
       3350,
      76790,
      80140 
],
[
 "NIO",
"2010Q2",
        130,
          0,
        130 
],
[
 "Scot Gov",
"2010Q2",
          0,
      16870,
      16870 
],
[
 "Welsh Gov",
"2010Q2",
          0,
       5910,
       5910 
],
[
 "AGO",
"2010Q3",
         50,
       9100,
       9150 
],
[
 "BIS",
"2010Q3",
       3760,
       8460,
      12220 
],
[
 "CO",
"2010Q3",
       1500,
       1950,
       3450 
],
[
 "DCLG",
"2010Q3",
       2520,
       2090,
       4610 
],
[
 "DCMS",
"2010Q3",
        460,
        110,
        570 
],
[
 "DECC",
"2010Q3",
       1120,
          0,
       1120 
],
[
 "DEFRA",
"2010Q3",
       2590,
       7070,
       9660 
],
[
 "DfE",
"2010Q3",
       2800,
       1670,
       4470 
],
[
 "DfID",
"2010Q3",
       1600,
          0,
       1600 
],
[
 "DfT",
"2010Q3",
       2070,
      16330,
      18400 
],
[
 "DH",
"2010Q3",
       2540,
       2570,
       5110 
],
[
 "DWP",
"2010Q3",
          0,
     115430,
     115430 
],
[
 "FCO",
"2010Q3",
       5900,
       5660,
      11560 
],
[
 "GEO",
"2010Q3",
        110,
          0,
        110 
],
[
 "HMT",
"2010Q3",
       1360,
      75140,
      76500 
],
[
 "HO",
"2010Q3",
          0,
      29070,
      29070 
],
[
 "MoD",
"2010Q3",
          0,
      73590,
      73590 
],
[
 "MoJ",
"2010Q3",
       3300,
      75930,
      79230 
],
[
 "NIO",
"2010Q3",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2010Q3",
          0,
      16820,
      16820 
],
[
 "Welsh Gov",
"2010Q3",
          0,
       5610,
       5610 
],
[
 "AGO",
"2010Q4",
         40,
       8980,
       9020 
],
[
 "BIS",
"2010Q4",
       3420,
       8200,
      11620 
],
[
 "CO",
"2010Q4",
       1460,
       1630,
       3090 
],
[
 "DCLG",
"2010Q4",
       2470,
       2050,
       4520 
],
[
 "DCMS",
"2010Q4",
        460,
        120,
        580 
],
[
 "DECC",
"2010Q4",
       1130,
          0,
       1130 
],
[
 "DEFRA",
"2010Q4",
       2570,
       6910,
       9480 
],
[
 "DfE",
"2010Q4",
       2740,
       1630,
       4370 
],
[
 "DfID",
"2010Q4",
       1580,
          0,
       1580 
],
[
 "DfT",
"2010Q4",
       2030,
      16120,
      18150 
],
[
 "DH",
"2010Q4",
       2570,
       2520,
       5090 
],
[
 "DWP",
"2010Q4",
          0,
     112320,
     112320 
],
[
 "FCO",
"2010Q4",
       5770,
       5630,
      11400 
],
[
 "GEO",
"2010Q4",
        110,
          0,
        110 
],
[
 "HMT",
"2010Q4",
       1300,
      74290,
      75590 
],
[
 "HO",
"2010Q4",
          0,
      27910,
      27910 
],
[
 "MoD",
"2010Q4",
          0,
      73130,
      73130 
],
[
 "MoJ",
"2010Q4",
       4470,
      74320,
      78790 
],
[
 "NIO",
"2010Q4",
        110,
          0,
        110 
],
[
 "Scot Gov",
"2010Q4",
          0,
      16690,
      16690 
],
[
 "Welsh Gov",
"2010Q4",
          0,
       5550,
       5550 
],
[
 "AGO",
"2011Q1",
         40,
       8900,
       8940 
],
[
 "BIS",
"2011Q1",
       3400,
       8120,
      11520 
],
[
 "CO",
"2011Q1",
       1520,
       1580,
       3100 
],
[
 "DCLG",
"2011Q1",
       2250,
       1950,
       4200 
],
[
 "DCMS",
"2011Q1",
        450,
        120,
        570 
],
[
 "DECC",
"2011Q1",
       1150,
          0,
       1150 
],
[
 "DEFRA",
"2011Q1",
       2530,
       6880,
       9410 
],
[
 "DfE",
"2011Q1",
       2660,
       1620,
       4280 
],
[
 "DfID",
"2011Q1",
       1570,
          0,
       1570 
],
[
 "DfT",
"2011Q1",
       1860,
      15810,
      17670 
],
[
 "DH",
"2011Q1",
       2560,
       2460,
       5020 
],
[
 "DWP",
"2011Q1",
          0,
     109590,
     109590 
],
[
 "FCO",
"2011Q1",
       5660,
       5370,
      11030 
],
[
 "GEO",
"2011Q1",
        110,
          0,
        110 
],
[
 "HMT",
"2011Q1",
       1240,
      80330,
      81570 
],
[
 "HO",
"2011Q1",
          0,
      27380,
      27380 
],
[
 "MoD",
"2011Q1",
          0,
      72080,
      72080 
],
[
 "MoJ",
"2011Q1",
       4510,
      73700,
      78210 
],
[
 "NIO",
"2011Q1",
        100,
          0,
        100 
],
[
 "Scot Gov",
"2011Q1",
          0,
      17890,
      17890 
],
[
 "Welsh Gov",
"2011Q1",
          0,
       5450,
       5450 
],
[
 "AGO",
"2011Q2",
         40,
       8670,
       8710 
],
[
 "BIS",
"2011Q2",
       3170,
       7630,
      10800 
],
[
 "CO",
"2011Q2",
       1630,
       1330,
       2960 
],
[
 "DCLG",
"2011Q2",
       2020,
       1910,
       3930 
],
[
 "DCMS",
"2011Q2",
        490,
        120,
        610 
],
[
 "DECC",
"2011Q2",
       1170,
          0,
       1170 
],
[
 "DEFRA",
"2011Q2",
       2340,
       6870,
       9210 
],
[
 "DfE",
"2011Q2",
       2490,
       1610,
       4100 
],
[
 "DfID",
"2011Q2",
       1560,
          0,
       1560 
],
[
 "DfT",
"2011Q2",
       1780,
      15600,
      17380 
],
[
 "DH",
"2011Q2",
       2390,
       2460,
       4850 
],
[
 "DWP",
"2011Q2",
          0,
     105700,
     105700 
],
[
 "FCO",
"2011Q2",
       5560,
       5350,
      10910 
],
[
 "GEO",
"2011Q2",
          0,
          0,
          0 
],
[
 "HMT",
"2011Q2",
       1170,
      74820,
      75990 
],
[
 "HO",
"2011Q2",
          0,
      26310,
      26310 
],
[
 "MoD",
"2011Q2",
          0,
      70680,
      70680 
],
[
 "MoJ",
"2011Q2",
       4300,
      71750,
      76050 
],
[
 "NIO",
"2011Q2",
         50,
          0,
         50 
],
[
 "Scot Gov",
"2011Q2",
          0,
      16300,
      16300 
],
[
 "Welsh Gov",
"2011Q2",
          0,
       5300,
       5300 
],
[
 "AGO",
"2011Q3",
         40,
       8460,
       8500 
],
[
 "BIS",
"2011Q3",
       2880,
      14880,
      17760 
],
[
 "CO",
"2011Q3",
       1630,
       1230,
       2860 
],
[
 "DCLG",
"2011Q3",
       2110,
        840,
       2950 
],
[
 "DCMS",
"2011Q3",
        460,
        110,
        570 
],
[
 "DECC",
"2011Q3",
       1190,
          0,
       1190 
],
[
 "DEFRA",
"2011Q3",
       2100,
       6560,
       8660 
],
[
 "DfE",
"2011Q3",
       2490,
       1590,
       4080 
],
[
 "DfID",
"2011Q3",
       1560,
          0,
       1560 
],
[
 "DfT",
"2011Q3",
       1710,
      15460,
      17170 
],
[
 "DH",
"2011Q3",
       2370,
       2240,
       4610 
],
[
 "DWP",
"2011Q3",
          0,
     102380,
     102380 
],
[
 "FCO",
"2011Q3",
       5450,
       5310,
      10760 
],
[
 "GEO",
"2011Q3",
          0,
          0,
          0 
],
[
 "HMT",
"2011Q3",
       1150,
      74060,
      75210 
],
[
 "HO",
"2011Q3",
          0,
      25580,
      25580 
],
[
 "MoD",
"2011Q3",
          0,
      68000,
      68000 
],
[
 "MoJ",
"2011Q3",
       4250,
      66470,
      70720 
],
[
 "NIO",
"2011Q3",
         50,
          0,
         50 
],
[
 "Scot Gov",
"2011Q3",
          0,
      16080,
      16080 
],
[
 "Welsh Gov",
"2011Q3",
          0,
       5110,
       5110 
],
[
 "AGO",
"2011Q4",
         40,
       8340,
       8380 
],
[
 "BIS",
"2011Q4",
       2910,
      14570,
      17480 
],
[
 "CO",
"2011Q4",
       1640,
       1200,
       2840 
],
[
 "DCLG",
"2011Q4",
       1860,
        840,
       2700 
],
[
 "DCMS",
"2011Q4",
        460,
        110,
        570 
],
[
 "DECC",
"2011Q4",
       1230,
          0,
       1230 
],
[
 "DEFRA",
"2011Q4",
       2080,
       6440,
       8520 
],
[
 "DfE",
"2011Q4",
       2580,
       1670,
       4250 
],
[
 "DfID",
"2011Q4",
       1620,
          0,
       1620 
],
[
 "DfT",
"2011Q4",
       1660,
      15370,
      17030 
],
[
 "DH",
"2011Q4",
       2330,
       2210,
       4540 
],
[
 "DWP",
"2011Q4",
          0,
     101100,
     101100 
],
[
 "FCO",
"2011Q4",
       5770,
       5290,
      11060 
],
[
 "GEO",
"2011Q4",
          0,
          0,
          0 
],
[
 "HMT",
"2011Q4",
       1130,
      73870,
      75000 
],
[
 "HO",
"2011Q4",
          0,
      24850,
      24850 
],
[
 "MoD",
"2011Q4",
          0,
      64590,
      64590 
],
[
 "MoJ",
"2011Q4",
       4160,
      64450,
      68610 
],
[
 "NIO",
"2011Q4",
         50,
          0,
         50 
],
[
 "Scot Gov",
"2011Q4",
          0,
      15800,
      15800 
],
[
 "Welsh Gov",
"2011Q4",
          0,
       5100,
       5100 
],
[
 "AGO",
"2012Q1",
         40,
       8340,
       8380 
],
[
 "BIS",
"2012Q1",
       2930,
      14220,
      17150 
],
[
 "CO",
"2012Q1",
       1710,
       1100,
       2810 
],
[
 "DCLG",
"2012Q1",
       1820,
        820,
       2640 
],
[
 "DCMS",
"2012Q1",
        450,
        120,
        570 
],
[
 "DECC",
"2012Q1",
       1290,
          0,
       1290 
],
[
 "DEFRA",
"2012Q1",
       2090,
       6400,
       8490 
],
[
 "DfE",
"2012Q1",
       2590,
       1670,
       4260 
],
[
 "DfID",
"2012Q1",
       1650,
          0,
       1650 
],
[
 "DfT",
"2012Q1",
       1630,
      15290,
      16920 
],
[
 "DH",
"2012Q1",
       2290,
       2180,
       4470 
],
[
 "DWP",
"2012Q1",
          0,
      99800,
      99800 
],
[
 "FCO",
"2012Q1",
       5780,
       5290,
      11070 
],
[
 "GEO",
"2012Q1",
          0,
          0,
          0 
],
[
 "HMT",
"2012Q1",
       1200,
      73340,
      74540 
],
[
 "HO",
"2012Q1",
          0,
      24640,
      24640 
],
[
 "MoD",
"2012Q1",
          0,
      61330,
      61330 
],
[
 "MoJ",
"2012Q1",
       4060,
      63290,
      67350 
],
[
 "NIO",
"2012Q1",
         60,
          0,
         60 
],
[
 "Scot Gov",
"2012Q1",
          0,
      15720,
      15720 
],
[
 "Welsh Gov",
"2012Q1",
          0,
       5170,
       5170 
],
[
 "AGO",
"2012Q2",
         40,
       8280,
       8320 
],
[
 "BIS",
"2012Q2",
          0,
      14220,
      14220 
],
[
 "CO",
"2012Q2",
       1800,
        720,
       2520 
],
[
 "DCLG",
"2012Q2",
       1700,
        840,
       2540 
],
[
 "DCMS",
"2012Q2",
        450,
        130,
        580 
],
[
 "DECC",
"2012Q2",
       1320,
          0,
       1320 
],
[
 "DEFRA",
"2012Q2",
       2060,
       6290,
       8350 
],
[
 "DfE",
"2012Q2",
       2630,
       1630,
       4260 
],
[
 "DfID",
"2012Q2",
       1690,
          0,
       1690 
],
[
 "DfT",
"2012Q2",
       1640,
      15200,
      16840 
],
[
 "DH",
"2012Q2",
       2270,
       2180,
       4450 
],
[
 "DWP",
"2012Q2",
          0,
      98210,
      98210 
],
[
 "FCO",
"2012Q2",
       6420,
       5260,
      11680 
],
[
 "GEO",
"2012Q2",
          0,
          0,
          0 
],
[
 "HMT",
"2012Q2",
       1160,
      72520,
      73680 
],
[
 "HO",
"2012Q2",
          0,
      24520,
      24520 
],
[
 "MoD",
"2012Q2",
          0,
      59640,
      59640 
],
[
 "MoJ",
"2012Q2",
       4260,
      61890,
      66150 
],
[
 "NIO",
"2012Q2",
         90,
          0,
         90 
],
[
 "Scot Gov",
"2012Q2",
          0,
      15770,
      15770 
],
[
 "Welsh Gov",
"2012Q2",
          0,
       5230,
       5230 
] 
];
data.addColumn('string','Dept');
data.addColumn('string','Period');
data.addColumn('number','FTE_WH');
data.addColumn('number','FTE_NWH');
data.addColumn('number','FTE_total');
data.addRows(datajson);
return(data);
}
 
// jsDrawChart
function drawChartMotionChartID9cc44be2e85() {
  var data = gvisDataMotionChartID9cc44be2e85();
  var options = {};
options["width"] =   1000;
options["height"] =    400;
options["state"] = "{\"playDuration\":10000,\n                       \"xZoomedDataMin\":0,\n                       \"xZoomedIn\":false,\n                       \"time\":\"2010-07-01\",\n                       \"yZoomedIn\":false,\n                       \"orderedByY\":false,\n                       \"sizeOption\":\"4\",\n                       \"xLambda\":1,\n                       \"colorOption\":\"2\",\n                       \"yZoomedDataMax\":130000,\n                       \"nonSelectedAlpha\":0.4,\n                       \"iconType\":\"BUBBLE\",\n                       \"dimensions\":{\"iconDimensions\":[\"dim0\"]},\n                       \"uniColorForNonSelected\":false,\n                       \"yZoomedDataMin\":0,\n                       \"xZoomedDataMax\":21,\n                       \"duration\":{\"multiplier\":1,\"timeUnit\":\"Q\"},\n                       \"xAxisOption\":\"3\",\n                       \"orderedByX\":true,\n                       \"showTrails\":false,\n                       \"yLambda\":1,\n                       \"yAxisOption\":\"2\",\n                       \"iconKeySettings\":[]};";
options["showSelectListComponent"] =      1;
options["showHeader"] =      1;
options["showAdvancedPanel"] =      1;
options["showChartButtons"] =      1;
options["showXScalePicker"] =      1;
options["showYScalePicker"] =      1;
options["showXMetricPicker"] =      1;
options["showYMetricPicker"] =      1;
options["showSidePanel"] =      1;

     var chart = new google.visualization.MotionChart(
       document.getElementById('MotionChartID9cc44be2e85')
     );
     chart.draw(data,options);
    

}
  
 
// jsDisplayChart 
function displayChartMotionChartID9cc44be2e85()
{
  google.load("visualization", "1", { packages:["motionchart"] }); 
  google.setOnLoadCallback(drawChartMotionChartID9cc44be2e85);
}
 
// jsChart 
displayChartMotionChartID9cc44be2e85()
 
<!-- jsFooter -->  
//-->
</script>
 
<!-- divChart -->
  
<div id="MotionChartID9cc44be2e85"
  style="width: 1000px; height: 400px;">
</div>


This is the code that will be used to create output files with chart
HTML/java code.

```r
setwd("~/GitHub/Charting-government/")
sink("reports/motionchart_HTML.txt")
invisible(print(Motion, "chart"))
invisible(sink())
```



Let's see a simple chart which will render right in the preview:

```r

library(ggplot2)
library(grid)
# order levels

DeptsFTEwithtotals$Dept <- reorder(DeptsFTEwithtotals$Dept,
                                   -DeptsFTEwithtotals$sFTE2012Q2) 

plot <-ggplot(DeptsFTEwithtotals,
              aes(x=factor(Dept),
                  y=FTE2012Q2,
                  fill=factor(Whitehall))) + 
  geom_bar(position="stack", binwidth=1) +
  guides(fill = guide_legend(reverse = FALSE, nrow =1,
                             direction="horizontal",
                             title="Legend")) +
  labs(y = "FTE in Q2 2012") +
  theme(legend.position="bottom",
        legend.key.size=unit(6,"pt"),
        panel.background=element_blank(),
        panel.grid.major.x=element_blank(),
        panel.grid.minor.y=element_blank(),
        panel.grid.major.y=element_line(colour="light grey"),
        axis.ticks=element_blank(),
        axis.text.x=element_text(angle=90, hjust=1, vjust=.5),
        axis.ticks.margin = unit(1,"pt"),
        axis.title.x=element_blank()
        )
```



![plot of chunk TotalsPlot_Chart](figure/TotalsPlot_Chart.png) 







```r
setwd("~/github/Charting-government/")
SumDeptsFTEAdj <- read.csv("data/SumDeptsFTEAdjusted.csv")

# remove total and blank rows
SumDeptsFTEAdj <- subset(SumDeptsFTEAdj, Dept != "TOTAL")
SumDeptsFTEAdj <- subset(SumDeptsFTEAdj, Dept != "TOTAL NWH")
SumDeptsFTEAdj <- subset(SumDeptsFTEAdj, Dept != "TOTAL WH")
SumDeptsFTEAdj <- subset(SumDeptsFTEAdj, Dept != "")

# get rid of mess in colnames, making it suitable for reshape and googlevis
names(SumDeptsFTEAdj) <- gsub("[.]","", names(SumDeptsFTEAdj))
names(SumDeptsFTEAdj) <- gsub("FTE","", names(SumDeptsFTEAdj))
names(SumDeptsFTEAdj) <- gsub("X","FTE", names(SumDeptsFTEAdj))

# reshape
SumDeptsFTEAdjlong <- reshape(SumDeptsFTEAdj, idvar = c("Dept","Whitehall"), 
                  varying = c(3:16),
                  v.names = c("FTE"),
                  times = c("2009Q1","2009Q2","2009Q3","2009Q4",
                            "2010Q1","2010Q2","2010Q3","2010Q4",
                            "2011Q1","2011Q2","2011Q3","2011Q4",
                            "2012Q1","2012Q2"),
                  timevar = "Period",
                  direction = "long")

# format date, rebuild dates from quarters
SumDeptsFTEAdjlong$Date <- SumDeptsFTEAdjlong$Period

SumDeptsFTEAdjlong$Date <- gsub("Q1","-03-31",SumDeptsFTEAdjlong$Date)
SumDeptsFTEAdjlong$Date <- gsub("Q2","-06-30",SumDeptsFTEAdjlong$Date)
SumDeptsFTEAdjlong$Date <- gsub("Q3","-09-30",SumDeptsFTEAdjlong$Date)
SumDeptsFTEAdjlong$Date <- gsub("Q4","-12-31",SumDeptsFTEAdjlong$Date)

SumDeptsFTEAdjlong$Date <- as.POSIXct(SumDeptsFTEAdjlong$Date, tz = "GMT")

# plot
library(scales)
plotFTEadj <- ggplot(SumDeptsFTEAdjlong, aes(x=Date,
                                   y=FTE/1000,
                                   fill=factor(Whitehall))) + 
                geom_area() +
                facet_wrap(~ Dept, ncol=3, scales = "free_y") +
                #facet_wrap(~ Dept, ncol=3) +
                theme(legend.position="bottom",
                      legend.key.size=unit(6,"pt"),
                      panel.background=element_blank(),
                      panel.grid.major.x=element_blank(),
                      panel.grid.minor.y=element_blank(),
                      panel.grid.major.y=element_line(colour="light grey"),
                      axis.ticks=element_blank(),
                      axis.text.x=element_text(angle=90, hjust=1, vjust=.5),
                      axis.ticks.margin = unit(1,"pt"),
                      axis.title.x=element_blank()
                      )+
                labs(y = "FTE (thousands)", x = "") + 
                #scale_x_date(breaks = "3 months", labels=date_format("%B")) +
                guides(fill = guide_legend(reverse = FALSE, nrow =1,
                                           direction="horizontal",
                                           title="Legend"))
plotFTEadj
```

![plot of chunk unnamed-chunk-9](figure/unnamed-chunk-9.png) 

